# ============================================
# PK SERVIZI - Environment Configuration
# ============================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control
# ============================================

# ============================================
# APPLICATION SETTINGS
# ============================================

# Node environment: development | staging | production
NODE_ENV=development

# Application port
PORT=3001

# Application URL (used for CORS, emails, etc.)
APP_URL=http://localhost:3001

# Frontend URLs (comma-separated, used for CORS)
# Example: https://app.pkservizi.it,https://admin.pkservizi.it
FRONTEND_URLS=http://localhost:3000,http://localhost:5173

# ============================================
# DATABASE CONFIGURATION
# ============================================

# PostgreSQL connection settings
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=your_database_password_here
DB_DATABASE=pk_servizi

# Enable TypeORM query logging (true/false)
# Set to true in development, false in production
TYPEORM_LOGGING=true

# Database connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10

# ============================================
# JWT AUTHENTICATION
# ============================================

# JWT secret key for access tokens
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your_jwt_secret_key_here_minimum_32_characters

# JWT access token expiration (e.g., 15m, 1h, 1d)
JWT_EXPIRES_IN=1h

# JWT refresh token secret key
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_REFRESH_SECRET=your_jwt_refresh_secret_key_here_minimum_32_characters

# JWT refresh token expiration (e.g., 7d, 30d, 90d)
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# RATE LIMITING & THROTTLING
# ============================================

# Throttle time window in milliseconds (default: 60000 = 1 minute)
THROTTLE_TTL=60000

# Maximum requests per time window (default: 100)
THROTTLE_LIMIT=100

# Global rate limit window in milliseconds (default: 60000 = 1 minute)
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per window (default: 300)
RATE_LIMIT_MAX=300

# ============================================
# STRIPE PAYMENT INTEGRATION
# ============================================
# Task Reference: TASK 2 in IMPLEMENTATION_TASKS.md

# Stripe secret key (starts with sk_test_ or sk_live_)
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here

# Stripe publishable key (starts with pk_test_ or pk_live_)
# Used by frontend applications
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here

# Stripe webhook signing secret (starts with whsec_)
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Stripe product and price IDs
# Create products and prices in Stripe Dashboard
STRIPE_PRICE_ID_MONTHLY=price_monthly_plan_id_here
STRIPE_PRICE_ID_ANNUAL=price_annual_plan_id_here

# Currency code (ISO 4217)
STRIPE_CURRENCY=EUR

# ============================================
# GOOGLE CLOUD STORAGE
# ============================================
# Task Reference: TASK 3 (Updated)

# Google Cloud Project ID
GOOGLE_CLOUD_PROJECT_ID=your-project-id

# Path to the JSON key file containing service account credentials
# Make sure this file is excluded from git via .gitignore
# Example: ./gcp-key.json
GOOGLE_APPLICATION_CREDENTIALS=./gcp-key.json

# Name of the GCS bucket
GOOGLE_CLOUD_STORAGE_BUCKET=your-bucket-name

# Maximum file size in MB
MAX_FILE_SIZE_MB=10

# Allowed file types (comma-separated MIME types)
ALLOWED_FILE_TYPES=application/pdf,image/jpeg,image/jpg,image/png

# Signed URL expiration in seconds (default: 3600 = 1 hour)
SIGNED_URL_EXPIRES_IN=3600

# ============================================
# EMAIL SERVICE (SENDGRID)
# ============================================
# Task Reference: TASK 8 in IMPLEMENTATION_TASKS.md

# SendGrid API key
# Get from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here

# From email address (must be verified in SendGrid)
EMAIL_FROM_ADDRESS=noreply@pkservizi.it

# From name
EMAIL_FROM_NAME=PK SERVIZI

# Enable/disable email notifications (true/false)
NOTIFICATION_ENABLED=true

# Admin notification email (receives system alerts)
ADMIN_EMAIL=admin@pkservizi.it

# ============================================
# APPOINTMENT SETTINGS
# ============================================
# Task Reference: TASK 6 in IMPLEMENTATION_TASKS.md

# Default appointment slot duration in minutes
APPOINTMENT_SLOT_DURATION=60

# How many days in advance users can book appointments
APPOINTMENT_BOOKING_ADVANCE_DAYS=30

# Minimum hours before appointment to allow cancellation
APPOINTMENT_CANCELLATION_HOURS=24

# Hours before appointment to send reminder notification
APPOINTMENT_REMINDER_HOURS=24

# ============================================
# NOTIFICATION SETTINGS
# ============================================

# Enable push notifications (true/false)
PUSH_NOTIFICATIONS_ENABLED=false

# Firebase Cloud Messaging server key (for push notifications)
# FCM_SERVER_KEY=your_fcm_server_key_here

# Enable SMS notifications (true/false)
SMS_NOTIFICATIONS_ENABLED=false

# Twilio credentials (if SMS enabled)
# TWILIO_ACCOUNT_SID=your_twilio_account_sid
# TWILIO_AUTH_TOKEN=your_twilio_auth_token
# TWILIO_PHONE_NUMBER=+1234567890

# ============================================
# SUBSCRIPTION SETTINGS
# ============================================
# Task Reference: TASK 12 in IMPLEMENTATION_TASKS.md

# Days before subscription expiry to send warning
SUBSCRIPTION_EXPIRY_WARNING_DAYS=7

# Grace period after subscription expires (days)
SUBSCRIPTION_GRACE_PERIOD_DAYS=3

# Allow service requests without active subscription (true/false)
# Set to false in production
ALLOW_REQUESTS_WITHOUT_SUBSCRIPTION=false

# ============================================
# DOCUMENT SETTINGS
# ============================================

# Document retention period in days (for GDPR compliance)
DOCUMENT_RETENTION_DAYS=2555

# Enable automatic document deletion after retention period (true/false)
AUTO_DELETE_EXPIRED_DOCUMENTS=false

# ============================================
# SECURITY SETTINGS
# ============================================

# Enable two-factor authentication (true/false)
TWO_FACTOR_AUTH_ENABLED=false

# Password reset token expiration in minutes
PASSWORD_RESET_TOKEN_EXPIRES_IN=60

# Maximum failed login attempts before account lockout
MAX_FAILED_LOGIN_ATTEMPTS=5

# Account lockout duration in minutes
ACCOUNT_LOCKOUT_DURATION=30

# Session timeout in minutes (for admin users)
SESSION_TIMEOUT_MINUTES=60

# Enable IP whitelisting for admin access (true/false)
ADMIN_IP_WHITELIST_ENABLED=false

# Whitelisted IP addresses (comma-separated)
# ADMIN_IP_WHITELIST=192.168.1.1,10.0.0.1

# ============================================
# CORS SETTINGS
# ============================================

# Additional allowed origins (comma-separated)
# Already includes FRONTEND_URLS
CORS_ADDITIONAL_ORIGINS=

# Allow credentials in CORS requests (true/false)
CORS_CREDENTIALS=true

# ============================================
# LOGGING & MONITORING
# ============================================

# Log level: error | warn | info | debug | verbose
LOG_LEVEL=info

# Enable file logging (true/false)
FILE_LOGGING_ENABLED=false

# Log file path
LOG_FILE_PATH=./logs/app.log

# Sentry DSN for error tracking (optional)
# Get from: https://sentry.io/settings/projects/
# SENTRY_DSN=https://your_sentry_dsn_here

# Enable Sentry in production only (true/false)
# SENTRY_ENABLED=false

# ============================================
# REDIS (OPTIONAL - for caching and sessions)
# ============================================

# Enable Redis (true/false)
REDIS_ENABLED=false

# Redis connection settings
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# Cache TTL in seconds
# CACHE_TTL=3600

# ============================================
# BACKUP & RECOVERY
# ============================================

# Enable automated backups (true/false)
AUTO_BACKUP_ENABLED=false

# Backup schedule (cron expression)
# Example: 0 2 * * * (every day at 2 AM)
# BACKUP_SCHEDULE=0 2 * * *

# Backup retention days
# BACKUP_RETENTION_DAYS=30

# Backup storage path or S3 bucket
# BACKUP_STORAGE_PATH=/backups

# ============================================
# FEATURE FLAGS
# ============================================

# Enable WebSocket real-time features (true/false)
WEBSOCKET_ENABLED=false

# Enable advanced reporting (true/false)
ADVANCED_REPORTING_ENABLED=false

# Enable multi-language support (true/false)
MULTI_LANGUAGE_ENABLED=false

# Default language (it | en)
DEFAULT_LANGUAGE=it

# Enable maintenance mode (true/false)
MAINTENANCE_MODE=false

# ============================================
# DEVELOPMENT & TESTING
# ============================================

# Enable Swagger API documentation (true/false)
# Set to false in production
SWAGGER_ENABLED=true

# Swagger path
SWAGGER_PATH=api/docs

# Enable database seeding on startup (true/false)
# Only for development
AUTO_SEED=false

# Enable debug mode (true/false)
DEBUG_MODE=false

# Mock external services (true/false)
# Useful for testing without real API keys
MOCK_EXTERNAL_SERVICES=false

# ============================================
# GDPR & COMPLIANCE
# ============================================

# Enable GDPR features (true/false)
GDPR_ENABLED=true

# Data retention policy in days
DATA_RETENTION_DAYS=2555

# Enable right to be forgotten (true/false)
RIGHT_TO_BE_FORGOTTEN_ENABLED=true

# Enable data export (true/false)
DATA_EXPORT_ENABLED=true

# Cookie consent required (true/false)
COOKIE_CONSENT_REQUIRED=true

# ============================================
# ANALYTICS (OPTIONAL)
# ============================================

# Google Analytics tracking ID
# GA_TRACKING_ID=UA-XXXXXXXXX-X

# Enable analytics (true/false)
# ANALYTICS_ENABLED=false

# ============================================
# THIRD-PARTY INTEGRATIONS (OPTIONAL)
# ============================================

# Google Maps API key (for address autocomplete)
# GOOGLE_MAPS_API_KEY=your_google_maps_api_key

# reCAPTCHA keys (for bot protection)
# RECAPTCHA_SITE_KEY=your_recaptcha_site_key
# RECAPTCHA_SECRET_KEY=your_recaptcha_secret_key

# ============================================
# CUSTOM BUSINESS LOGIC
# ============================================

# Fiscal year start month (1-12)
FISCAL_YEAR_START_MONTH=1

# Business hours (for appointment scheduling)
BUSINESS_HOURS_START=09:00
BUSINESS_HOURS_END=18:00

# Business days (comma-separated: 0=Sunday, 1=Monday, etc.)
BUSINESS_DAYS=1,2,3,4,5

# Timezone
TZ=Europe/Rome

# ============================================
# NOTES
# ============================================
# 1. Generate secure random keys for JWT secrets
# 2. Never commit .env file to version control
# 3. Use different values for development, staging, and production
# 4. Rotate secrets regularly (every 90 days recommended)
# 5. Use environment-specific .env files (.env.development, .env.production)
# 6. Validate all required variables on application startup
# 7. Use a secrets management service in production (AWS Secrets Manager, HashiCorp Vault, etc.)
# ============================================
